INSERT INTO CAMPAIGN_WATERFALL_SUMMARY
SELECT
C.RATE_DT AS "Rate Date",
EXCLUSION,
CASE WHEN  "Email Refi" = 0 THEN NULL ELSE  "Email Refi" END AS  "Email Refi",
CASE WHEN  "Email Purchase" = 0 THEN NULL ELSE  "Email Purchase" END AS  "Email Purchase",
CASE WHEN  "Email One Day Sale" = 0 THEN NULL ELSE  "Email One Day Sale" END AS  "Email One Day Sale",
CASE WHEN  "Email Servicing" = 0 THEN NULL ELSE  "Email Servicing" END AS  "Email Servicing",
CASE WHEN  "Email Racing" = 0 THEN NULL ELSE  "Email Racing" END AS  "Email Racing",
CASE WHEN  "Direct Mail Refi" = 0 THEN NULL ELSE  "Direct Mail Refi" END AS  "Direct Mail Refi",
CASE WHEN  "Direct Mail Purchase" = 0 THEN NULL ELSE  "Direct Mail Purchase" END AS  "Direct Mail Purchase",
CASE WHEN  "Direct Mail Servicing" = 0 THEN NULL ELSE  "Direct Mail Servicing" END AS  "Direct Mail Servicing",
CASE WHEN  "Direct Mail Racing" = 0 THEN NULL ELSE  "Direct Mail Racing" END AS  "Direct Mail Racing",
CASE WHEN  "Servicing Transfers" = 0 THEN NULL ELSE  "Servicing Transfers" END AS  "Servicing Transfers",
CASE WHEN  "Statement Insert Servicing" = 0 THEN NULL ELSE  "Statement Insert Servicing" END AS  "Statement Insert Servicing",
CASE WHEN  "Statement Insert Refi" = 0 THEN NULL ELSE  "Statement Insert Refi" END AS  "Statement Insert Refi",
CASE WHEN  "Statement Insert Purchase" = 0 THEN NULL ELSE  "Statement Insert Purchase" END AS  "Statement Insert Purchase",
CASE WHEN  "All HAMP Mod DM" = 0 THEN NULL ELSE  "All HAMP Mod DM" END AS  "All HAMP Mod DM",
CASE WHEN  "Forbearance Loans DM" = 0 THEN NULL ELSE  "Forbearance Loans DM" END AS  "Forbearance Loans DM",
CASE WHEN  "Second Lien DM" = 0 THEN NULL ELSE  "Second Lien DM" END AS  "Second Lien DM"

FROM
(
	SELECT
	CASE WHEN EXCLUSION = '9999-SELECTED' THEN '9000-SELECTED' ELSE EXCLUSION END AS EXCLUSION,
	SUM(DECODE(OFFER_1, 8001, CNT1)) AS "Email Refi",
	SUM(DECODE(OFFER_2, 8002, CNT2)) AS "Email Purchase",
	SUM(DECODE(OFFER_3, 8003, CNT3)) AS "Email One Day Sale",
	SUM(DECODE(OFFER_4, 8004, CNT4)) AS "Email Servicing",
	SUM(DECODE(OFFER_5, 8005, CNT5)) AS "Email Racing",
	SUM(DECODE(OFFER_6, 8006, CNT6)) AS "Direct Mail Refi",
	SUM(DECODE(OFFER_7, 8007, CNT7)) AS "Direct Mail Purchase",
	SUM(DECODE(OFFER_8, 8008, CNT8)) AS "Direct Mail Servicing",
	SUM(DECODE(OFFER_9, 8009, CNT9)) AS "Direct Mail Racing",
	SUM(DECODE(OFFER_10, 8010, CNT10)) AS "Servicing Transfers",
	SUM(DECODE(OFFER_11, 8011, CNT11)) AS "Statement Insert Servicing",
	SUM(DECODE(OFFER_12, 8012, CNT12)) AS "Statement Insert Refi",
	SUM(DECODE(OFFER_13, 8013, CNT13)) AS "Statement Insert Purchase",
	SUM(DECODE(OFFER_14, 8207, CNT14)) AS "All HAMP Mod DM",
	SUM(DECODE(OFFER_15, 8208, CNT15)) AS "Forbearance Loans DM",
	SUM(DECODE(OFFER_16, 8108, CNT16)) AS "Second Lien DM"
	FROM
		(
		SELECT DISTINCT
		CASE WHEN EXCLUSION_CODE = '1' THEN '9999-SELECTED' ELSE EXCLUSION_CODE ||'-'||EXCLUSION_DESC END AS EXCLUSION
		FROM CAMPAIGN_EXCLUSIONS_T
		WHERE OFFER_KEY < 8014 AND EXCLUSION_CODE NOT IN (1000)
		AND ACTIVE_FLAG = 'Y'
		) E,
		(
		SELECT
		OFFER_1,
		EXCL_1,
		COUNT(*) AS CNT1
		FROM CE_LOANS WHERE BORROWER_TYPE = 'P'
		GROUP BY
		OFFER_1,
		EXCL_1
		) L1,
		(
		SELECT
		OFFER_2,
		EXCL_2,
		COUNT(*) AS CNT2
		FROM CE_LOANS WHERE BORROWER_TYPE = 'P'
		GROUP BY
		OFFER_2,
		EXCL_2
		) L2,
		(
		SELECT
		OFFER_3,
		EXCL_3,
		COUNT(*) AS CNT3
		FROM CE_LOANS WHERE BORROWER_TYPE = 'P'
		GROUP BY
		OFFER_3,
		EXCL_3
		) L3,
		(
		SELECT
		OFFER_4,
		EXCL_4,
		COUNT(*) AS CNT4
		FROM CE_LOANS WHERE BORROWER_TYPE = 'P'
		GROUP BY
		OFFER_4,
		EXCL_4
		) L4,
		(
		SELECT
		OFFER_5,
		EXCL_5,
		COUNT(*) AS CNT5
		FROM CE_LOANS WHERE BORROWER_TYPE = 'P'
		GROUP BY
		OFFER_5,
		EXCL_5
		) L5,
		(
		SELECT
		OFFER_6,
		EXCL_6,
		COUNT(*) AS CNT6
		FROM CE_LOANS
		WHERE BORROWER_TYPE = 'P'
		GROUP BY
		OFFER_6,
		EXCL_6
		) L6,
		(
		SELECT
		OFFER_7,
		EXCL_7,
		COUNT(*) AS CNT7
		FROM CE_LOANS
		WHERE BORROWER_TYPE = 'P'
		GROUP BY
		OFFER_7,
		EXCL_7
		) L7,
		(
		SELECT
		OFFER_8,
		EXCL_8,
		COUNT(*) AS CNT8
		FROM CE_LOANS
		WHERE BORROWER_TYPE = 'P'
		GROUP BY
		OFFER_8,
		EXCL_8
		) L8,
		(
		SELECT
		OFFER_9,
		EXCL_9,
		COUNT(*) AS CNT9
		FROM CE_LOANS
		WHERE BORROWER_TYPE = 'P'
		GROUP BY
		OFFER_9,
		EXCL_9
		) L9,
		(
		SELECT
		OFFER_10,
		EXCL_10,
		COUNT(*) AS CNT10
		FROM CE_LOANS
		WHERE BORROWER_TYPE = 'P'
		GROUP BY
		OFFER_10,
		EXCL_10
		) L10,
		(
		SELECT
		OFFER_11,
		EXCL_11,
		COUNT(*) AS CNT11
		FROM CE_LOANS
		WHERE BORROWER_TYPE = 'P'
		GROUP BY
		OFFER_11,
		EXCL_11
		) L11,
		(
		SELECT
		OFFER_12,
		EXCL_12,
		COUNT(*) AS CNT12
		FROM CE_LOANS
		WHERE BORROWER_TYPE = 'P'
		GROUP BY
		OFFER_12,
		EXCL_12
		) L12,
		(
		SELECT
		OFFER_13,
		EXCL_13,
		COUNT(*) AS CNT13
		FROM CE_LOANS
		WHERE BORROWER_TYPE = 'P'
		GROUP BY
		OFFER_13,
		EXCL_13
		) L13,
		(
		SELECT
		OFFER_14,
		EXCL_14,
		COUNT(*) AS CNT14
		FROM CE_LOANS
		WHERE BORROWER_TYPE = 'P' AND (FLG_NOT_FNMA_MOD = 'N' OR FLG_NOT_HAMP_MOD = 'N')
		GROUP BY
		OFFER_14,
		EXCL_14
		) L14,
		(
		SELECT
		OFFER_15,
		EXCL_15,
		COUNT(*) AS CNT15
		FROM CE_LOANS
		WHERE BORROWER_TYPE = 'P' AND FLG_FB = 'Y'
		GROUP BY
		OFFER_15,
		EXCL_15
		) L15,
		(
		SELECT
		OFFER_16,
		EXCL_16,
		COUNT(*) AS CNT16
		FROM CE_LOANS
		WHERE BORROWER_TYPE = 'P'
		GROUP BY
		OFFER_16,
		EXCL_16
		) L16
	WHERE E.EXCLUSION = L1.EXCL_1(+)
	AND E.EXCLUSION = L2.EXCL_2(+)
	AND E.EXCLUSION = L3.EXCL_3(+)
	AND E.EXCLUSION = L4.EXCL_4(+)
	AND E.EXCLUSION = L5.EXCL_5(+)
	AND E.EXCLUSION = L6.EXCL_6(+)
	AND E.EXCLUSION = L7.EXCL_7(+)
	AND E.EXCLUSION = L8.EXCL_8(+)
	AND E.EXCLUSION = L9.EXCL_9(+)
	AND E.EXCLUSION = L10.EXCL_10(+)
	AND E.EXCLUSION = L11.EXCL_11(+)
	AND E.EXCLUSION = L12.EXCL_12(+)
	AND E.EXCLUSION = L13.EXCL_13(+)
	AND E.EXCLUSION = L14.EXCL_14(+)
	AND E.EXCLUSION = L15.EXCL_15(+)
	AND E.EXCLUSION = L16.EXCL_16(+)
	GROUP BY EXCLUSION

	UNION ALL

	SELECT
	EXCLUSION,
	SUM(DECODE(OFFER, 8001, CNT)) AS "Email Refi",
	SUM(DECODE(OFFER, 8002, CNT)) AS "Email Purchase",
	SUM(DECODE(OFFER, 8003, CNT)) AS "Email One Day Sale",
	SUM(DECODE(OFFER, 8004, CNT)) AS "Email Servicing",
	SUM(DECODE(OFFER, 8005, CNT)) AS "Email Racing",
	SUM(DECODE(OFFER, 8006, CNT)) AS "Direct Mail Refi",
	SUM(DECODE(OFFER, 8007, CNT)) AS "Direct Mail Purchase",
	SUM(DECODE(OFFER, 8008, CNT)) AS "Direct Mail Servicing",
	SUM(DECODE(OFFER, 8009, CNT)) AS "Direct Mail Racing",
	SUM(DECODE(OFFER, 8010, CNT)) AS "Servicing Transfers",
	SUM(DECODE(OFFER, 8011, CNT)) AS "Statement Insert Servicing",
	SUM(DECODE(OFFER, 8012, CNT)) AS "Statement Insert Refi",
	SUM(DECODE(OFFER, 8013, CNT)) AS "Statement Insert Purchase",
	SUM(DECODE(OFFER, 8207, CNT)) AS "All HAMP Mod DM",
	SUM(DECODE(OFFER, 8208, CNT)) AS "Forbearance Loans DM",
	SUM(DECODE(OFFER, 8108, CNT)) AS "Second Lien DM"
	FROM
	(
		SELECT
		OFFER_1 AS OFFER,
		CASE WHEN NVL(LTV_B,0) >= 80 THEN
		CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9001-New PI Savings < $0 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9005-New PI Savings $1-$49 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN  '9009-New PI Savings >= $50 HARP >80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9003-New PI Savings < $0 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9007-New PI Savings $1-$49 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9011-New PI Savings >= $50 Non-HARP >80' ELSE '9013-Not Priced' END
		END
		ELSE
				CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9002-New PI Savings < $0 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9006-New PI Savings $1-$49 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9010-New PI Savings >= $50 HARP <80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9004-New PI Savings < $0 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9008-New PI Savings $1-$49 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9012-New PI Savings >= $50 Non-HARP <80' ELSE '9013-Not Priced' END
		END
		END AS EXCLUSION,
		COUNT(*) AS CNT
		FROM CE_LOANS
		WHERE EXCL_1 = '9999-SELECTED' AND BORROWER_TYPE = 'P'
		GROUP BY
		OFFER_1,
		CASE WHEN NVL(LTV_B,0) >= 80 THEN
		CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9001-New PI Savings < $0 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9005-New PI Savings $1-$49 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN  '9009-New PI Savings >= $50 HARP >80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9003-New PI Savings < $0 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9007-New PI Savings $1-$49 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9011-New PI Savings >= $50 Non-HARP >80' ELSE '9013-Not Priced' END
		END
		ELSE
				CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9002-New PI Savings < $0 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9006-New PI Savings $1-$49 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9010-New PI Savings >= $50 HARP <80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9004-New PI Savings < $0 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9008-New PI Savings $1-$49 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9012-New PI Savings >= $50 Non-HARP <80' ELSE '9013-Not Priced' END
		END
		END

		UNION ALL

		SELECT
		OFFER_2 AS OFFER,
		CASE WHEN NVL(LTV_B,0) >= 80 THEN
		CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9001-New PI Savings < $0 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9005-New PI Savings $1-$49 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN  '9009-New PI Savings >= $50 HARP >80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9003-New PI Savings < $0 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9007-New PI Savings $1-$49 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9011-New PI Savings >= $50 Non-HARP >80' ELSE '9013-Not Priced' END
		END
		ELSE
				CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9002-New PI Savings < $0 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9006-New PI Savings $1-$49 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9010-New PI Savings >= $50 HARP <80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9004-New PI Savings < $0 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9008-New PI Savings $1-$49 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9012-New PI Savings >= $50 Non-HARP <80' ELSE '9013-Not Priced' END
		END
		END AS EXCLUSION,
		COUNT(*) AS CNT
		FROM CE_LOANS
		WHERE EXCL_2 = '9999-SELECTED' AND BORROWER_TYPE = 'P'
		GROUP BY
		OFFER_2,
		CASE WHEN NVL(LTV_B,0) >= 80 THEN
		CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9001-New PI Savings < $0 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9005-New PI Savings $1-$49 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN  '9009-New PI Savings >= $50 HARP >80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9003-New PI Savings < $0 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9007-New PI Savings $1-$49 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9011-New PI Savings >= $50 Non-HARP >80' ELSE '9013-Not Priced' END
		END
		ELSE
				CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9002-New PI Savings < $0 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9006-New PI Savings $1-$49 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9010-New PI Savings >= $50 HARP <80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9004-New PI Savings < $0 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9008-New PI Savings $1-$49 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9012-New PI Savings >= $50 Non-HARP <80' ELSE '9013-Not Priced' END
		END
		END

		UNION ALL

		SELECT
		OFFER_3 AS OFFER,
		CASE WHEN NVL(LTV_B,0) >= 80 THEN
		CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9001-New PI Savings < $0 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9005-New PI Savings $1-$49 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN  '9009-New PI Savings >= $50 HARP >80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9003-New PI Savings < $0 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9007-New PI Savings $1-$49 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9011-New PI Savings >= $50 Non-HARP >80' ELSE '9013-Not Priced' END
		END
		ELSE
				CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9002-New PI Savings < $0 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9006-New PI Savings $1-$49 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9010-New PI Savings >= $50 HARP <80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9004-New PI Savings < $0 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9008-New PI Savings $1-$49 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9012-New PI Savings >= $50 Non-HARP <80' ELSE '9013-Not Priced' END
		END
		END AS EXCLUSION,
		COUNT(*) AS CNT
		FROM CE_LOANS
		WHERE EXCL_3 = '9999-SELECTED' AND BORROWER_TYPE = 'P'
		GROUP BY
		OFFER_3,
		CASE WHEN NVL(LTV_B,0) >= 80 THEN
		CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9001-New PI Savings < $0 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9005-New PI Savings $1-$49 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN  '9009-New PI Savings >= $50 HARP >80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9003-New PI Savings < $0 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9007-New PI Savings $1-$49 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9011-New PI Savings >= $50 Non-HARP >80' ELSE '9013-Not Priced' END
		END
		ELSE
				CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9002-New PI Savings < $0 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9006-New PI Savings $1-$49 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9010-New PI Savings >= $50 HARP <80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9004-New PI Savings < $0 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9008-New PI Savings $1-$49 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9012-New PI Savings >= $50 Non-HARP <80' ELSE '9013-Not Priced' END
		END
		END

		UNION ALL

		SELECT
		OFFER_4 AS OFFER,
		CASE WHEN NVL(LTV_B,0) >= 80 THEN
		CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9001-New PI Savings < $0 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9005-New PI Savings $1-$49 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN  '9009-New PI Savings >= $50 HARP >80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9003-New PI Savings < $0 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9007-New PI Savings $1-$49 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9011-New PI Savings >= $50 Non-HARP >80' ELSE '9013-Not Priced' END
		END
		ELSE
				CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9002-New PI Savings < $0 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9006-New PI Savings $1-$49 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9010-New PI Savings >= $50 HARP <80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9004-New PI Savings < $0 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9008-New PI Savings $1-$49 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9012-New PI Savings >= $50 Non-HARP <80' ELSE '9013-Not Priced' END
		END
		END AS EXCLUSION,
		COUNT(*) AS CNT
		FROM CE_LOANS
		WHERE EXCL_4 = '9999-SELECTED' AND BORROWER_TYPE = 'P'
		GROUP BY
		OFFER_4,
		CASE WHEN NVL(LTV_B,0) >= 80 THEN
		CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9001-New PI Savings < $0 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9005-New PI Savings $1-$49 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN  '9009-New PI Savings >= $50 HARP >80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9003-New PI Savings < $0 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9007-New PI Savings $1-$49 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9011-New PI Savings >= $50 Non-HARP >80' ELSE '9013-Not Priced' END
		END
		ELSE
				CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9002-New PI Savings < $0 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9006-New PI Savings $1-$49 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9010-New PI Savings >= $50 HARP <80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9004-New PI Savings < $0 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9008-New PI Savings $1-$49 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9012-New PI Savings >= $50 Non-HARP <80' ELSE '9013-Not Priced' END
		END
		END

		UNION ALL

		SELECT
		OFFER_5 AS OFFER,
		CASE WHEN NVL(LTV_B,0) >= 80 THEN
		CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9001-New PI Savings < $0 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9005-New PI Savings $1-$49 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN  '9009-New PI Savings >= $50 HARP >80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9003-New PI Savings < $0 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9007-New PI Savings $1-$49 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9011-New PI Savings >= $50 Non-HARP >80' ELSE '9013-Not Priced' END
		END
		ELSE
				CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9002-New PI Savings < $0 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9006-New PI Savings $1-$49 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9010-New PI Savings >= $50 HARP <80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9004-New PI Savings < $0 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9008-New PI Savings $1-$49 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9012-New PI Savings >= $50 Non-HARP <80' ELSE '9013-Not Priced' END
		END
		END AS EXCLUSION,
		COUNT(*) AS CNT
		FROM CE_LOANS
		WHERE EXCL_5 = '9999-SELECTED' AND BORROWER_TYPE = 'P'
		GROUP BY
		OFFER_5,
		CASE WHEN NVL(LTV_B,0) >= 80 THEN
		CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9001-New PI Savings < $0 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9005-New PI Savings $1-$49 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN  '9009-New PI Savings >= $50 HARP >80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9003-New PI Savings < $0 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9007-New PI Savings $1-$49 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9011-New PI Savings >= $50 Non-HARP >80' ELSE '9013-Not Priced' END
		END
		ELSE
				CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9002-New PI Savings < $0 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9006-New PI Savings $1-$49 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9010-New PI Savings >= $50 HARP <80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9004-New PI Savings < $0 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9008-New PI Savings $1-$49 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9012-New PI Savings >= $50 Non-HARP <80' ELSE '9013-Not Priced' END
		END
		END

		UNION ALL

		SELECT
		OFFER_6 AS OFFER,
		CASE WHEN NVL(LTV_B,0) >= 80 THEN
		CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9001-New PI Savings < $0 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9005-New PI Savings $1-$49 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN  '9009-New PI Savings >= $50 HARP >80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9003-New PI Savings < $0 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9007-New PI Savings $1-$49 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9011-New PI Savings >= $50 Non-HARP >80' ELSE '9013-Not Priced' END
		END
		ELSE
				CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9002-New PI Savings < $0 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9006-New PI Savings $1-$49 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9010-New PI Savings >= $50 HARP <80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9004-New PI Savings < $0 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9008-New PI Savings $1-$49 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9012-New PI Savings >= $50 Non-HARP <80' ELSE '9013-Not Priced' END
		END
		END AS EXCLUSION,
		COUNT(*) AS CNT
		FROM CE_LOANS
		WHERE EXCL_6 = '9999-SELECTED'
		AND BORROWER_TYPE = 'P'
		GROUP BY
		OFFER_6,
		CASE WHEN NVL(LTV_B,0) >= 80 THEN
		CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9001-New PI Savings < $0 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9005-New PI Savings $1-$49 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN  '9009-New PI Savings >= $50 HARP >80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9003-New PI Savings < $0 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9007-New PI Savings $1-$49 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9011-New PI Savings >= $50 Non-HARP >80' ELSE '9013-Not Priced' END
		END
		ELSE
				CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9002-New PI Savings < $0 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9006-New PI Savings $1-$49 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9010-New PI Savings >= $50 HARP <80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9004-New PI Savings < $0 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9008-New PI Savings $1-$49 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9012-New PI Savings >= $50 Non-HARP <80' ELSE '9013-Not Priced' END
		END
		END

		UNION ALL

		SELECT
		OFFER_7 AS OFFER,
		CASE WHEN NVL(LTV_B,0) >= 80 THEN
		CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9001-New PI Savings < $0 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9005-New PI Savings $1-$49 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN  '9009-New PI Savings >= $50 HARP >80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9003-New PI Savings < $0 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9007-New PI Savings $1-$49 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9011-New PI Savings >= $50 Non-HARP >80' ELSE '9013-Not Priced' END
		END
		ELSE
				CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9002-New PI Savings < $0 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9006-New PI Savings $1-$49 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9010-New PI Savings >= $50 HARP <80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9004-New PI Savings < $0 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9008-New PI Savings $1-$49 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9012-New PI Savings >= $50 Non-HARP <80' ELSE '9013-Not Priced' END
		END
		END AS EXCLUSION,
		COUNT(*) AS CNT
		FROM CE_LOANS
		WHERE EXCL_7 = '9999-SELECTED'
		AND BORROWER_TYPE = 'P'
		GROUP BY
		OFFER_7,
		CASE WHEN NVL(LTV_B,0) >= 80 THEN
		CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9001-New PI Savings < $0 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9005-New PI Savings $1-$49 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN  '9009-New PI Savings >= $50 HARP >80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9003-New PI Savings < $0 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9007-New PI Savings $1-$49 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9011-New PI Savings >= $50 Non-HARP >80' ELSE '9013-Not Priced' END
		END
		ELSE
				CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9002-New PI Savings < $0 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9006-New PI Savings $1-$49 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9010-New PI Savings >= $50 HARP <80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9004-New PI Savings < $0 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9008-New PI Savings $1-$49 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9012-New PI Savings >= $50 Non-HARP <80' ELSE '9013-Not Priced' END
		END
		END

		UNION ALL

		SELECT
		OFFER_8 AS OFFER,
		CASE WHEN NVL(LTV_B,0) >= 80 THEN
		CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9001-New PI Savings < $0 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9005-New PI Savings $1-$49 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN  '9009-New PI Savings >= $50 HARP >80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9003-New PI Savings < $0 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9007-New PI Savings $1-$49 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9011-New PI Savings >= $50 Non-HARP >80' ELSE '9013-Not Priced' END
		END
		ELSE
				CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9002-New PI Savings < $0 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9006-New PI Savings $1-$49 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9010-New PI Savings >= $50 HARP <80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9004-New PI Savings < $0 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9008-New PI Savings $1-$49 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9012-New PI Savings >= $50 Non-HARP <80' ELSE '9013-Not Priced' END
		END
		END AS EXCLUSION,
		COUNT(*) AS CNT
		FROM CE_LOANS
		WHERE EXCL_8 = '9999-SELECTED'
		AND BORROWER_TYPE = 'P'
		GROUP BY
		OFFER_8,
		CASE WHEN NVL(LTV_B,0) >= 80 THEN
		CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9001-New PI Savings < $0 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9005-New PI Savings $1-$49 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN  '9009-New PI Savings >= $50 HARP >80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9003-New PI Savings < $0 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9007-New PI Savings $1-$49 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9011-New PI Savings >= $50 Non-HARP >80' ELSE '9013-Not Priced' END
		END
		ELSE
				CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9002-New PI Savings < $0 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9006-New PI Savings $1-$49 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9010-New PI Savings >= $50 HARP <80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9004-New PI Savings < $0 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9008-New PI Savings $1-$49 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9012-New PI Savings >= $50 Non-HARP <80' ELSE '9013-Not Priced' END
		END
		END

		UNION ALL

		SELECT
		OFFER_9 AS OFFER,
		CASE WHEN NVL(LTV_B,0) >= 80 THEN
		CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9001-New PI Savings < $0 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9005-New PI Savings $1-$49 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN  '9009-New PI Savings >= $50 HARP >80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9003-New PI Savings < $0 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9007-New PI Savings $1-$49 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9011-New PI Savings >= $50 Non-HARP >80' ELSE '9013-Not Priced' END
		END
		ELSE
				CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9002-New PI Savings < $0 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9006-New PI Savings $1-$49 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9010-New PI Savings >= $50 HARP <80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9004-New PI Savings < $0 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9008-New PI Savings $1-$49 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9012-New PI Savings >= $50 Non-HARP <80' ELSE '9013-Not Priced' END
		END
		END AS EXCLUSION,
		COUNT(*) AS CNT
		FROM CE_LOANS
		WHERE EXCL_9 = '9999-SELECTED'
		AND BORROWER_TYPE = 'P'
		GROUP BY
		OFFER_9,
		CASE WHEN NVL(LTV_B,0) >= 80 THEN
		CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9001-New PI Savings < $0 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9005-New PI Savings $1-$49 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN  '9009-New PI Savings >= $50 HARP >80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9003-New PI Savings < $0 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9007-New PI Savings $1-$49 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9011-New PI Savings >= $50 Non-HARP >80' ELSE '9013-Not Priced' END
		END
		ELSE
				CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9002-New PI Savings < $0 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9006-New PI Savings $1-$49 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9010-New PI Savings >= $50 HARP <80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9004-New PI Savings < $0 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9008-New PI Savings $1-$49 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9012-New PI Savings >= $50 Non-HARP <80' ELSE '9013-Not Priced' END
		END
		END

		UNION ALL

		SELECT
		OFFER_10 AS OFFER,
		CASE WHEN NVL(LTV_B,0) >= 80 THEN
		CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9001-New PI Savings < $0 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9005-New PI Savings $1-$49 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN  '9009-New PI Savings >= $50 HARP >80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9003-New PI Savings < $0 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9007-New PI Savings $1-$49 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9011-New PI Savings >= $50 Non-HARP >80' ELSE '9013-Not Priced' END
		END
		ELSE
				CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9002-New PI Savings < $0 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9006-New PI Savings $1-$49 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9010-New PI Savings >= $50 HARP <80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9004-New PI Savings < $0 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9008-New PI Savings $1-$49 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9012-New PI Savings >= $50 Non-HARP <80' ELSE '9013-Not Priced' END
		END
		END AS EXCLUSION,
		COUNT(*) AS CNT
		FROM CE_LOANS
		WHERE EXCL_10 = '9999-SELECTED'
		AND BORROWER_TYPE = 'P'
		GROUP BY
		OFFER_10,
		CASE WHEN NVL(LTV_B,0) >= 80 THEN
		CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9001-New PI Savings < $0 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9005-New PI Savings $1-$49 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN  '9009-New PI Savings >= $50 HARP >80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9003-New PI Savings < $0 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9007-New PI Savings $1-$49 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9011-New PI Savings >= $50 Non-HARP >80' ELSE '9013-Not Priced' END
		END
		ELSE
				CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9002-New PI Savings < $0 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9006-New PI Savings $1-$49 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9010-New PI Savings >= $50 HARP <80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9004-New PI Savings < $0 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9008-New PI Savings $1-$49 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9012-New PI Savings >= $50 Non-HARP <80' ELSE '9013-Not Priced' END
		END
		END

		UNION ALL

		SELECT
		OFFER_11 AS OFFER,
		CASE WHEN NVL(LTV_B,0) >= 80 THEN
		CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9001-New PI Savings < $0 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9005-New PI Savings $1-$49 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN  '9009-New PI Savings >= $50 HARP >80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9003-New PI Savings < $0 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9007-New PI Savings $1-$49 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9011-New PI Savings >= $50 Non-HARP >80' ELSE '9013-Not Priced' END
		END
		ELSE
				CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9002-New PI Savings < $0 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9006-New PI Savings $1-$49 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9010-New PI Savings >= $50 HARP <80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9004-New PI Savings < $0 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9008-New PI Savings $1-$49 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9012-New PI Savings >= $50 Non-HARP <80' ELSE '9013-Not Priced' END
		END
		END AS EXCLUSION,
		COUNT(*) AS CNT
		FROM CE_LOANS
		WHERE EXCL_11 = '9999-SELECTED'
		AND BORROWER_TYPE = 'P'
		GROUP BY
		OFFER_11,
		CASE WHEN NVL(LTV_B,0) >= 80 THEN
		CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9001-New PI Savings < $0 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9005-New PI Savings $1-$49 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN  '9009-New PI Savings >= $50 HARP >80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9003-New PI Savings < $0 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9007-New PI Savings $1-$49 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9011-New PI Savings >= $50 Non-HARP >80' ELSE '9013-Not Priced' END
		END
		ELSE
				CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9002-New PI Savings < $0 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9006-New PI Savings $1-$49 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9010-New PI Savings >= $50 HARP <80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9004-New PI Savings < $0 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9008-New PI Savings $1-$49 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9012-New PI Savings >= $50 Non-HARP <80' ELSE '9013-Not Priced' END
		END
		END

		UNION ALL

		SELECT
		OFFER_12 AS OFFER,
		CASE WHEN NVL(LTV_B,0) >= 80 THEN
		CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9001-New PI Savings < $0 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9005-New PI Savings $1-$49 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN  '9009-New PI Savings >= $50 HARP >80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9003-New PI Savings < $0 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9007-New PI Savings $1-$49 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9011-New PI Savings >= $50 Non-HARP >80' ELSE '9013-Not Priced' END
		END
		ELSE
				CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9002-New PI Savings < $0 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9006-New PI Savings $1-$49 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9010-New PI Savings >= $50 HARP <80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9004-New PI Savings < $0 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9008-New PI Savings $1-$49 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9012-New PI Savings >= $50 Non-HARP <80' ELSE '9013-Not Priced' END
		END
		END AS EXCLUSION,
		COUNT(*) AS CNT
		FROM CE_LOANS
		WHERE EXCL_12 = '9999-SELECTED'
		AND BORROWER_TYPE = 'P'
		GROUP BY
		OFFER_12,
		CASE WHEN NVL(LTV_B,0) >= 80 THEN
		CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9001-New PI Savings < $0 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9005-New PI Savings $1-$49 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN  '9009-New PI Savings >= $50 HARP >80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9003-New PI Savings < $0 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9007-New PI Savings $1-$49 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9011-New PI Savings >= $50 Non-HARP >80' ELSE '9013-Not Priced' END
		END
		ELSE
				CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9002-New PI Savings < $0 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9006-New PI Savings $1-$49 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9010-New PI Savings >= $50 HARP <80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9004-New PI Savings < $0 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9008-New PI Savings $1-$49 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9012-New PI Savings >= $50 Non-HARP <80' ELSE '9013-Not Priced' END
		END
		END

		UNION ALL

		SELECT
		OFFER_13 AS OFFER,
		CASE WHEN NVL(LTV_B,0) >= 80 THEN
		CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9001-New PI Savings < $0 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9005-New PI Savings $1-$49 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN  '9009-New PI Savings >= $50 HARP >80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9003-New PI Savings < $0 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9007-New PI Savings $1-$49 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9011-New PI Savings >= $50 Non-HARP >80' ELSE '9013-Not Priced' END
		END
		ELSE
				CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9002-New PI Savings < $0 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9006-New PI Savings $1-$49 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9010-New PI Savings >= $50 HARP <80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9004-New PI Savings < $0 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9008-New PI Savings $1-$49 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9012-New PI Savings >= $50 Non-HARP <80' ELSE '9013-Not Priced' END
		END
		END AS EXCLUSION,
		COUNT(*) AS CNT
		FROM CE_LOANS
		WHERE EXCL_13 = '9999-SELECTED'
		AND BORROWER_TYPE = 'P'
		GROUP BY
		OFFER_13,
		CASE WHEN NVL(LTV_B,0) >= 80 THEN
		CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9001-New PI Savings < $0 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9005-New PI Savings $1-$49 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN  '9009-New PI Savings >= $50 HARP >80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9003-New PI Savings < $0 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9007-New PI Savings $1-$49 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9011-New PI Savings >= $50 Non-HARP >80' ELSE '9013-Not Priced' END
		END
		ELSE
				CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9002-New PI Savings < $0 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9006-New PI Savings $1-$49 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9010-New PI Savings >= $50 HARP <80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9004-New PI Savings < $0 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9008-New PI Savings $1-$49 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9012-New PI Savings >= $50 Non-HARP <80' ELSE '9013-Not Priced' END
		END
		END

		UNION ALL

		SELECT
		OFFER_14 AS OFFER,
		CASE WHEN NVL(LTV_B,0) >= 80 THEN
		CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9001-New PI Savings < $0 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9005-New PI Savings $1-$49 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN  '9009-New PI Savings >= $50 HARP >80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9003-New PI Savings < $0 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9007-New PI Savings $1-$49 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9011-New PI Savings >= $50 Non-HARP >80' ELSE '9013-Not Priced' END
		END
		ELSE
				CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9002-New PI Savings < $0 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9006-New PI Savings $1-$49 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9010-New PI Savings >= $50 HARP <80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9004-New PI Savings < $0 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9008-New PI Savings $1-$49 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9012-New PI Savings >= $50 Non-HARP <80' ELSE '9013-Not Priced' END
		END
		END AS EXCLUSION,
		COUNT(*) AS CNT
		FROM CE_LOANS
		WHERE EXCL_14 = '9999-SELECTED'
		AND BORROWER_TYPE = 'P' AND (FLG_NOT_FNMA_MOD = 'N' OR FLG_NOT_HAMP_MOD = 'N')
		GROUP BY
		OFFER_14,
		CASE WHEN NVL(LTV_B,0) >= 80 THEN
		CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9001-New PI Savings < $0 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9005-New PI Savings $1-$49 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN  '9009-New PI Savings >= $50 HARP >80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9003-New PI Savings < $0 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9007-New PI Savings $1-$49 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9011-New PI Savings >= $50 Non-HARP >80' ELSE '9013-Not Priced' END
		END
		ELSE
				CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9002-New PI Savings < $0 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9006-New PI Savings $1-$49 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9010-New PI Savings >= $50 HARP <80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9004-New PI Savings < $0 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9008-New PI Savings $1-$49 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9012-New PI Savings >= $50 Non-HARP <80' ELSE '9013-Not Priced' END
		END
		END

		UNION ALL

		SELECT
		OFFER_15 AS OFFER,
		CASE WHEN NVL(LTV_B,0) >= 80 THEN
		CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9001-New PI Savings < $0 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9005-New PI Savings $1-$49 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN  '9009-New PI Savings >= $50 HARP >80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9003-New PI Savings < $0 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9007-New PI Savings $1-$49 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9011-New PI Savings >= $50 Non-HARP >80' ELSE '9013-Not Priced' END
		END
		ELSE
				CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9002-New PI Savings < $0 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9006-New PI Savings $1-$49 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9010-New PI Savings >= $50 HARP <80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9004-New PI Savings < $0 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9008-New PI Savings $1-$49 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9012-New PI Savings >= $50 Non-HARP <80' ELSE '9013-Not Priced' END
		END
		END AS EXCLUSION,
		COUNT(*) AS CNT
		FROM CE_LOANS
		WHERE EXCL_15 = '9999-SELECTED'
		AND BORROWER_TYPE = 'P' AND FLG_FB = 'Y'
		GROUP BY
		OFFER_15,
		CASE WHEN NVL(LTV_B,0) >= 80 THEN
		CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9001-New PI Savings < $0 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9005-New PI Savings $1-$49 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN  '9009-New PI Savings >= $50 HARP >80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9003-New PI Savings < $0 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9007-New PI Savings $1-$49 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9011-New PI Savings >= $50 Non-HARP >80' ELSE '9013-Not Priced' END
		END
		ELSE
				CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9002-New PI Savings < $0 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9006-New PI Savings $1-$49 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9010-New PI Savings >= $50 HARP <80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9004-New PI Savings < $0 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9008-New PI Savings $1-$49 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9012-New PI Savings >= $50 Non-HARP <80' ELSE '9013-Not Priced' END
		END
		END

		UNION ALL

		SELECT
		OFFER_16 AS OFFER,
		CASE WHEN NVL(LTV_B,0) >= 80 THEN
		CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9001-New PI Savings < $0 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9005-New PI Savings $1-$49 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN  '9009-New PI Savings >= $50 HARP >80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9003-New PI Savings < $0 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9007-New PI Savings $1-$49 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9011-New PI Savings >= $50 Non-HARP >80' ELSE '9013-Not Priced' END
		END
		ELSE
				CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9002-New PI Savings < $0 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9006-New PI Savings $1-$49 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9010-New PI Savings >= $50 HARP <80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9004-New PI Savings < $0 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9008-New PI Savings $1-$49 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9012-New PI Savings >= $50 Non-HARP <80' ELSE '9013-Not Priced' END
		END
		END AS EXCLUSION,
		COUNT(*) AS CNT
		FROM CE_LOANS
		WHERE EXCL_16 = '9999-SELECTED'
		AND BORROWER_TYPE = 'P'
		GROUP BY
		OFFER_16,
		CASE WHEN NVL(LTV_B,0) >= 80 THEN
		CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9001-New PI Savings < $0 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9005-New PI Savings $1-$49 HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN  '9009-New PI Savings >= $50 HARP >80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9003-New PI Savings < $0 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9007-New PI Savings $1-$49 Non-HARP >80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9011-New PI Savings >= $50 Non-HARP >80' ELSE '9013-Not Priced' END
		END
		ELSE
				CASE WHEN CURRENT_PROPERTY_METHOD IN ('IPV', 'HVE') THEN
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9002-New PI Savings < $0 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9006-New PI Savings $1-$49 HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9010-New PI Savings >= $50 HARP <80' ELSE '9013-Not Priced' END
		ELSE
		     CASE WHEN NEW_PI_SAVINGS_MO <= 0 THEN '9004-New PI Savings < $0 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO < 50 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69 AND UNPAID_BALANCE < 95000)) THEN '9008-New PI Savings $1-$49 Non-HARP <80'
		          WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9012-New PI Savings >= $50 Non-HARP <80' ELSE '9013-Not Priced' END
		END
		END
	)
	GROUP BY
	EXCLUSION

	UNION ALL

	SELECT
	EXCLUSION,
	SUM(DECODE(OFFER, 8001, CNT)) AS "Email Refi",
	SUM(DECODE(OFFER, 8002, CNT)) AS "Email Purchase",
	SUM(DECODE(OFFER, 8003, CNT)) AS "Email One Day Sale",
	SUM(DECODE(OFFER, 8004, CNT)) AS "Email Servicing",
	SUM(DECODE(OFFER, 8005, CNT)) AS "Email Racing",
	SUM(DECODE(OFFER, 8006, CNT)) AS "Direct Mail Refi",
	SUM(DECODE(OFFER, 8007, CNT)) AS "Direct Mail Purchase",
	SUM(DECODE(OFFER, 8008, CNT)) AS "Direct Mail Servicing",
	SUM(DECODE(OFFER, 8009, CNT)) AS "Direct Mail Racing",
	SUM(DECODE(OFFER, 8010, CNT)) AS "Servicing Transfers",
	SUM(DECODE(OFFER, 8011, CNT)) AS "Statement Insert Servicing",
	SUM(DECODE(OFFER, 8012, CNT)) AS "Statement Insert Refi",
	SUM(DECODE(OFFER, 8013, CNT)) AS "Statement Insert Purchase",
	SUM(DECODE(OFFER, 8207, CNT)) AS "All HAMP Mod DM",
	SUM(DECODE(OFFER, 8208, CNT)) AS "Forbearance Loans DM",
	SUM(DECODE(OFFER, 8108, CNT)) AS "Second Lien DM"
	FROM
	(
		SELECT
		OFFER_1 AS OFFER,
		CASE WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9018-Late Fee with Pricing' ELSE '9019-Late Fee Without Pricing' END AS EXCLUSION,
		COUNT(*) AS CNT
		FROM CE_LOANS
		WHERE EXCL_1 LIKE '6027-%' AND BORROWER_TYPE = 'P' /*AND LATE_FEE >= 500*/
		GROUP BY
		OFFER_1,
		CASE WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9018-Late Fee with Pricing' ELSE '9019-Late Fee Without Pricing' END

		UNION ALL

		SELECT
		OFFER_2 AS OFFER,
		CASE WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9018-Late Fee with Pricing' ELSE '9019-Late Fee Without Pricing' END AS EXCLUSION,
		COUNT(*) AS CNT
		FROM CE_LOANS
		WHERE EXCL_2 LIKE '6027-%' AND BORROWER_TYPE = 'P' /*AND LATE_FEE >= 500*/
		GROUP BY
		OFFER_2,
		CASE WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9018-Late Fee with Pricing' ELSE '9019-Late Fee Without Pricing' END

		UNION ALL

		SELECT
		OFFER_3 AS OFFER,
		CASE WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9018-Late Fee with Pricing' ELSE '9019-Late Fee Without Pricing' END AS EXCLUSION,
		COUNT(*) AS CNT
		FROM CE_LOANS
		WHERE EXCL_3 LIKE '6027-%' AND BORROWER_TYPE = 'P' /*AND LATE_FEE >= 500*/
		GROUP BY
		OFFER_3,
		CASE WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9018-Late Fee with Pricing' ELSE '9019-Late Fee Without Pricing' END

		UNION ALL

		SELECT
		OFFER_4 AS OFFER,
		CASE WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9018-Late Fee with Pricing' ELSE '9019-Late Fee Without Pricing' END AS EXCLUSION,
		COUNT(*) AS CNT
		FROM CE_LOANS
		WHERE EXCL_4 LIKE '6027-%' AND BORROWER_TYPE = 'P' /*AND LATE_FEE >= 500*/
		GROUP BY
		OFFER_4,
		CASE WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9018-Late Fee with Pricing' ELSE '9019-Late Fee Without Pricing' END

		UNION ALL

		SELECT
		OFFER_5 AS OFFER,
		CASE WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9018-Late Fee with Pricing' ELSE '9019-Late Fee Without Pricing' END AS EXCLUSION,
		COUNT(*) AS CNT
		FROM CE_LOANS
		WHERE EXCL_5 LIKE '6027-%' AND BORROWER_TYPE = 'P' /*AND LATE_FEE >= 500*/
		GROUP BY
		OFFER_5,
		CASE WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9018-Late Fee with Pricing' ELSE '9019-Late Fee Without Pricing' END

		UNION ALL

		SELECT
		OFFER_6 AS OFFER,
		CASE WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9018-Late Fee with Pricing' ELSE '9019-Late Fee Without Pricing' END AS EXCLUSION,
		COUNT(*) AS CNT
		FROM CE_LOANS
		WHERE EXCL_6 LIKE '6027-%' AND BORROWER_TYPE = 'P' /*AND LATE_FEE >= 500*/
		GROUP BY
		OFFER_6,
		CASE WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9018-Late Fee with Pricing' ELSE '9019-Late Fee Without Pricing' END

		UNION ALL

		SELECT
		OFFER_7 AS OFFER,
		CASE WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9018-Late Fee with Pricing' ELSE '9019-Late Fee Without Pricing' END AS EXCLUSION,
		COUNT(*) AS CNT
		FROM CE_LOANS
		WHERE EXCL_7 LIKE '6027-%' AND BORROWER_TYPE = 'P' /*AND LATE_FEE >= 500*/
		GROUP BY
		OFFER_7,
		CASE WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9018-Late Fee with Pricing' ELSE '9019-Late Fee Without Pricing' END

		UNION ALL

		SELECT
		OFFER_8 AS OFFER,
		CASE WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9018-Late Fee with Pricing' ELSE '9019-Late Fee Without Pricing' END AS EXCLUSION,
		COUNT(*) AS CNT
		FROM CE_LOANS
		WHERE EXCL_8 LIKE '6027-%' AND BORROWER_TYPE = 'P' /*AND LATE_FEE >= 500*/
		GROUP BY
		OFFER_8,
		CASE WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9018-Late Fee with Pricing' ELSE '9019-Late Fee Without Pricing' END

		UNION ALL

		SELECT
		OFFER_9 AS OFFER,
		CASE WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9018-Late Fee with Pricing' ELSE '9019-Late Fee Without Pricing' END AS EXCLUSION,
		COUNT(*) AS CNT
		FROM CE_LOANS
		WHERE EXCL_9 LIKE '6027-%' AND BORROWER_TYPE = 'P' /*AND LATE_FEE >= 500*/
		GROUP BY
		OFFER_9,
		CASE WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9018-Late Fee with Pricing' ELSE '9019-Late Fee Without Pricing' END

		UNION ALL

		SELECT
		OFFER_10 AS OFFER,
		CASE WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9018-Late Fee with Pricing' ELSE '9019-Late Fee Without Pricing' END AS EXCLUSION,
		COUNT(*) AS CNT
		FROM CE_LOANS
		WHERE EXCL_10 LIKE '6027-%' AND BORROWER_TYPE = 'P' /*AND LATE_FEE >= 500*/
		GROUP BY
		OFFER_10,
		CASE WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9018-Late Fee with Pricing' ELSE '9019-Late Fee Without Pricing' END

		UNION ALL

		SELECT
		OFFER_11 AS OFFER,
		CASE WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9018-Late Fee with Pricing' ELSE '9019-Late Fee Without Pricing' END AS EXCLUSION,
		COUNT(*) AS CNT
		FROM CE_LOANS
		WHERE EXCL_11 LIKE '6027-%' AND BORROWER_TYPE = 'P' /*AND LATE_FEE >= 500*/
		GROUP BY
		OFFER_11,
		CASE WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9018-Late Fee with Pricing' ELSE '9019-Late Fee Without Pricing' END

		UNION ALL

		SELECT
		OFFER_12 AS OFFER,
		CASE WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9018-Late Fee with Pricing' ELSE '9019-Late Fee Without Pricing' END AS EXCLUSION,
		COUNT(*) AS CNT
		FROM CE_LOANS
		WHERE EXCL_12 LIKE '6027-%' AND BORROWER_TYPE = 'P' /*AND LATE_FEE >= 500*/
		GROUP BY
		OFFER_12,
		CASE WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9018-Late Fee with Pricing' ELSE '9019-Late Fee Without Pricing' END

		UNION ALL

		SELECT
		OFFER_13 AS OFFER,
		CASE WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9018-Late Fee with Pricing' ELSE '9019-Late Fee Without Pricing' END AS EXCLUSION,
		COUNT(*) AS CNT
		FROM CE_LOANS
		WHERE EXCL_13 LIKE '6027-%' AND BORROWER_TYPE = 'P' /*AND LATE_FEE >= 500*/
		GROUP BY
		OFFER_13,
		CASE WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9018-Late Fee with Pricing' ELSE '9019-Late Fee Without Pricing' END

		UNION ALL

		SELECT
		OFFER_14 AS OFFER,
		CASE WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9018-Late Fee with Pricing' ELSE '9019-Late Fee Without Pricing' END AS EXCLUSION,
		SUM(0) AS CNT
		FROM CE_LOANS
		WHERE EXCL_14 LIKE '6027-%' AND BORROWER_TYPE = 'P' /*AND LATE_FEE >= 500*/ AND (FLG_NOT_FNMA_MOD = 'N' OR FLG_NOT_HAMP_MOD = 'N')
		GROUP BY
		OFFER_14,
		CASE WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9018-Late Fee with Pricing' ELSE '9019-Late Fee Without Pricing' END

		UNION ALL

		SELECT
		OFFER_15 AS OFFER,
		CASE WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9018-Late Fee with Pricing' ELSE '9019-Late Fee Without Pricing' END AS EXCLUSION,
		SUM(0) AS CNT
		FROM CE_LOANS
		WHERE EXCL_15 LIKE '6027-%' AND BORROWER_TYPE = 'P' /*AND LATE_FEE >= 500*/ AND FLG_FB = 'Y'
		GROUP BY
		OFFER_15,
		CASE WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9018-Late Fee with Pricing' ELSE '9019-Late Fee Without Pricing' END

		UNION ALL

		SELECT
		OFFER_16 AS OFFER,
		CASE WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9018-Late Fee with Pricing' ELSE '9019-Late Fee Without Pricing' END AS EXCLUSION,
		SUM(0) AS CNT
		FROM CE_LOANS
		WHERE EXCL_16 LIKE '6027-%' AND BORROWER_TYPE = 'P' /*AND LATE_FEE >= 500*/
		GROUP BY
		OFFER_16,
		CASE WHEN (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) THEN '9018-Late Fee with Pricing' ELSE '9019-Late Fee Without Pricing' END
	)
	GROUP BY
	EXCLUSION

UNION ALL

	SELECT
	EXCLUSION,
	SUM(DECODE(OFFER, 8001, CNT)) AS "Email Refi",
	SUM(DECODE(OFFER, 8002, CNT)) AS "Email Purchase",
	SUM(DECODE(OFFER, 8003, CNT)) AS "Email One Day Sale",
	SUM(DECODE(OFFER, 8004, CNT)) AS "Email Servicing",
	SUM(DECODE(OFFER, 8005, CNT)) AS "Email Racing",
	SUM(DECODE(OFFER, 8006, CNT)) AS "Direct Mail Refi",
	SUM(DECODE(OFFER, 8007, CNT)) AS "Direct Mail Purchase",
	SUM(DECODE(OFFER, 8008, CNT)) AS "Direct Mail Servicing",
	SUM(DECODE(OFFER, 8009, CNT)) AS "Direct Mail Racing",
	SUM(DECODE(OFFER, 8010, CNT)) AS "Servicing Transfers",
	SUM(DECODE(OFFER, 8011, CNT)) AS "Statement Insert Servicing",
	SUM(DECODE(OFFER, 8012, CNT)) AS "Statement Insert Refi",
	SUM(DECODE(OFFER, 8013, CNT)) AS "Statement Insert Purchase",
	SUM(DECODE(OFFER, 8207, CNT)) AS "All HAMP Mod DM",
	SUM(DECODE(OFFER, 8208, CNT)) AS "Forbearance Loans DM",
	SUM(DECODE(OFFER, 8108, CNT)) AS "Second Lien DM"
	FROM
	(
		SELECT
		OFFER_1 AS OFFER,
		CASE WHEN LTV_B >= 80 THEN CASE WHEN SPL_CHK = 'Y' THEN '9014-Options Eligible >=$50 (HARP) > 80' ELSE '9015-Single Choice Eligible >= $50 (HARP) > 80' END ELSE CASE WHEN SPL_CHK = 'Y' THEN '9016-Options Eligible >=$50 < 80' ELSE '9017-Single Choice Eligible >=$50 < 80' END END AS EXCLUSION,
		COUNT(*) AS CNT
		FROM CE_LOANS
		WHERE EXCL_1 = '9999-SELECTED' AND BORROWER_TYPE = 'P' AND (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) AND (LTV_B <= 80 OR FLG_GSE_VALUE = 'N')
		GROUP BY
		OFFER_1,
		CASE WHEN LTV_B >= 80 THEN CASE WHEN SPL_CHK = 'Y' THEN '9014-Options Eligible >=$50 (HARP) > 80' ELSE '9015-Single Choice Eligible >= $50 (HARP) > 80' END ELSE CASE WHEN SPL_CHK = 'Y' THEN '9016-Options Eligible >=$50 < 80' ELSE '9017-Single Choice Eligible >=$50 < 80' END END

		UNION ALL

		SELECT
		OFFER_2 AS OFFER,
		CASE WHEN LTV_B >= 80 THEN CASE WHEN SPL_CHK = 'Y' THEN '9014-Options Eligible >=$50 (HARP) > 80' ELSE '9015-Single Choice Eligible >= $50 (HARP) > 80' END ELSE CASE WHEN SPL_CHK = 'Y' THEN '9016-Options Eligible >=$50 < 80' ELSE '9017-Single Choice Eligible >=$50 < 80' END END AS EXCLUSION,
		COUNT(*) AS CNT
		FROM CE_LOANS
		WHERE EXCL_2 = '9999-SELECTED' AND BORROWER_TYPE = 'P' AND (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) AND (LTV_B <= 80 OR FLG_GSE_VALUE = 'N')
		GROUP BY
		OFFER_2,
		CASE WHEN LTV_B >= 80 THEN CASE WHEN SPL_CHK = 'Y' THEN '9014-Options Eligible >=$50 (HARP) > 80' ELSE '9015-Single Choice Eligible >= $50 (HARP) > 80' END ELSE CASE WHEN SPL_CHK = 'Y' THEN '9016-Options Eligible >=$50 < 80' ELSE '9017-Single Choice Eligible >=$50 < 80' END END

		UNION ALL

		SELECT
		OFFER_3 AS OFFER,
		CASE WHEN LTV_B >= 80 THEN CASE WHEN SPL_CHK = 'Y' THEN '9014-Options Eligible >=$50 (HARP) > 80' ELSE '9015-Single Choice Eligible >= $50 (HARP) > 80' END ELSE CASE WHEN SPL_CHK = 'Y' THEN '9016-Options Eligible >=$50 < 80' ELSE '9017-Single Choice Eligible >=$50 < 80' END END AS EXCLUSION,
		COUNT(*) AS CNT
		FROM CE_LOANS
		WHERE EXCL_3 = '9999-SELECTED' AND BORROWER_TYPE = 'P' AND (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) AND (LTV_B <= 80 OR FLG_GSE_VALUE = 'N')
		GROUP BY
		OFFER_3,
		CASE WHEN LTV_B >= 80 THEN CASE WHEN SPL_CHK = 'Y' THEN '9014-Options Eligible >=$50 (HARP) > 80' ELSE '9015-Single Choice Eligible >= $50 (HARP) > 80' END ELSE CASE WHEN SPL_CHK = 'Y' THEN '9016-Options Eligible >=$50 < 80' ELSE '9017-Single Choice Eligible >=$50 < 80' END END

		UNION ALL

		SELECT
		OFFER_4 AS OFFER,
		CASE WHEN LTV_B >= 80 THEN CASE WHEN SPL_CHK = 'Y' THEN '9014-Options Eligible >=$50 (HARP) > 80' ELSE '9015-Single Choice Eligible >= $50 (HARP) > 80' END ELSE CASE WHEN SPL_CHK = 'Y' THEN '9016-Options Eligible >=$50 < 80' ELSE '9017-Single Choice Eligible >=$50 < 80' END END AS EXCLUSION,
		COUNT(*) AS CNT
		FROM CE_LOANS
		WHERE EXCL_4 = '9999-SELECTED' AND BORROWER_TYPE = 'P' AND (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) AND (LTV_B <= 80 OR FLG_GSE_VALUE = 'N')
		GROUP BY
		OFFER_4,
		CASE WHEN LTV_B >= 80 THEN CASE WHEN SPL_CHK = 'Y' THEN '9014-Options Eligible >=$50 (HARP) > 80' ELSE '9015-Single Choice Eligible >= $50 (HARP) > 80' END ELSE CASE WHEN SPL_CHK = 'Y' THEN '9016-Options Eligible >=$50 < 80' ELSE '9017-Single Choice Eligible >=$50 < 80' END END

		UNION ALL

		SELECT
		OFFER_5 AS OFFER,
		CASE WHEN LTV_B >= 80 THEN CASE WHEN SPL_CHK = 'Y' THEN '9014-Options Eligible >=$50 (HARP) > 80' ELSE '9015-Single Choice Eligible >= $50 (HARP) > 80' END ELSE CASE WHEN SPL_CHK = 'Y' THEN '9016-Options Eligible >=$50 < 80' ELSE '9017-Single Choice Eligible >=$50 < 80' END END AS EXCLUSION,
		COUNT(*) AS CNT
		FROM CE_LOANS
		WHERE EXCL_5 = '9999-SELECTED' AND BORROWER_TYPE = 'P' AND (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) AND (LTV_B <= 80 OR FLG_GSE_VALUE = 'N')
		GROUP BY
		OFFER_5,
		CASE WHEN LTV_B >= 80 THEN CASE WHEN SPL_CHK = 'Y' THEN '9014-Options Eligible >=$50 (HARP) > 80' ELSE '9015-Single Choice Eligible >= $50 (HARP) > 80' END ELSE CASE WHEN SPL_CHK = 'Y' THEN '9016-Options Eligible >=$50 < 80' ELSE '9017-Single Choice Eligible >=$50 < 80' END END

		UNION ALL

		SELECT
		OFFER_6 AS OFFER,
		CASE WHEN LTV_B >= 80 THEN CASE WHEN SPL_CHK = 'Y' THEN '9014-Options Eligible >=$50 (HARP) > 80' ELSE '9015-Single Choice Eligible >= $50 (HARP) > 80' END ELSE CASE WHEN SPL_CHK = 'Y' THEN '9016-Options Eligible >=$50 < 80' ELSE '9017-Single Choice Eligible >=$50 < 80' END END AS EXCLUSION,
		COUNT(*) AS CNT
		FROM CE_LOANS
		WHERE EXCL_6 = '9999-SELECTED' AND BORROWER_TYPE = 'P' AND (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) AND (LTV_B <= 80 OR FLG_GSE_VALUE = 'N')
		GROUP BY
		OFFER_6,
		CASE WHEN LTV_B >= 80 THEN CASE WHEN SPL_CHK = 'Y' THEN '9014-Options Eligible >=$50 (HARP) > 80' ELSE '9015-Single Choice Eligible >= $50 (HARP) > 80' END ELSE CASE WHEN SPL_CHK = 'Y' THEN '9016-Options Eligible >=$50 < 80' ELSE '9017-Single Choice Eligible >=$50 < 80' END END

		UNION ALL

		SELECT
		OFFER_7 AS OFFER,
		CASE WHEN LTV_B >= 80 THEN CASE WHEN SPL_CHK = 'Y' THEN '9014-Options Eligible >=$50 (HARP) > 80' ELSE '9015-Single Choice Eligible >= $50 (HARP) > 80' END ELSE CASE WHEN SPL_CHK = 'Y' THEN '9016-Options Eligible >=$50 < 80' ELSE '9017-Single Choice Eligible >=$50 < 80' END END AS EXCLUSION,
		COUNT(*) AS CNT
		FROM CE_LOANS
		WHERE EXCL_7 = '9999-SELECTED' AND BORROWER_TYPE = 'P' AND (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) AND (LTV_B <= 80 OR FLG_GSE_VALUE = 'N')
		GROUP BY
		OFFER_7,
		CASE WHEN LTV_B >= 80 THEN CASE WHEN SPL_CHK = 'Y' THEN '9014-Options Eligible >=$50 (HARP) > 80' ELSE '9015-Single Choice Eligible >= $50 (HARP) > 80' END ELSE CASE WHEN SPL_CHK = 'Y' THEN '9016-Options Eligible >=$50 < 80' ELSE '9017-Single Choice Eligible >=$50 < 80' END END

		UNION ALL

		SELECT
		OFFER_8 AS OFFER,
		CASE WHEN LTV_B >= 80 THEN CASE WHEN SPL_CHK = 'Y' THEN '9014-Options Eligible >=$50 (HARP) > 80' ELSE '9015-Single Choice Eligible >= $50 (HARP) > 80' END ELSE CASE WHEN SPL_CHK = 'Y' THEN '9016-Options Eligible >=$50 < 80' ELSE '9017-Single Choice Eligible >=$50 < 80' END END AS EXCLUSION,
		COUNT(*) AS CNT
		FROM CE_LOANS
		WHERE EXCL_8 = '9999-SELECTED' AND BORROWER_TYPE = 'P' AND (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) AND (LTV_B <= 80 OR FLG_GSE_VALUE = 'N')
		GROUP BY
		OFFER_8,
		CASE WHEN LTV_B >= 80 THEN CASE WHEN SPL_CHK = 'Y' THEN '9014-Options Eligible >=$50 (HARP) > 80' ELSE '9015-Single Choice Eligible >= $50 (HARP) > 80' END ELSE CASE WHEN SPL_CHK = 'Y' THEN '9016-Options Eligible >=$50 < 80' ELSE '9017-Single Choice Eligible >=$50 < 80' END END

		UNION ALL

		SELECT
		OFFER_9 AS OFFER,
		CASE WHEN LTV_B >= 80 THEN CASE WHEN SPL_CHK = 'Y' THEN '9014-Options Eligible >=$50 (HARP) > 80' ELSE '9015-Single Choice Eligible >= $50 (HARP) > 80' END ELSE CASE WHEN SPL_CHK = 'Y' THEN '9016-Options Eligible >=$50 < 80' ELSE '9017-Single Choice Eligible >=$50 < 80' END END AS EXCLUSION,
		COUNT(*) AS CNT
		FROM CE_LOANS
		WHERE EXCL_9 = '9999-SELECTED' AND BORROWER_TYPE = 'P' AND (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) AND (LTV_B <= 80 OR FLG_GSE_VALUE = 'N')
		GROUP BY
		OFFER_9,
		CASE WHEN LTV_B >= 80 THEN CASE WHEN SPL_CHK = 'Y' THEN '9014-Options Eligible >=$50 (HARP) > 80' ELSE '9015-Single Choice Eligible >= $50 (HARP) > 80' END ELSE CASE WHEN SPL_CHK = 'Y' THEN '9016-Options Eligible >=$50 < 80' ELSE '9017-Single Choice Eligible >=$50 < 80' END END

		UNION ALL

		SELECT
		OFFER_10 AS OFFER,
		CASE WHEN LTV_B >= 80 THEN CASE WHEN SPL_CHK = 'Y' THEN '9014-Options Eligible >=$50 (HARP) > 80' ELSE '9015-Single Choice Eligible >= $50 (HARP) > 80' END ELSE CASE WHEN SPL_CHK = 'Y' THEN '9016-Options Eligible >=$50 < 80' ELSE '9017-Single Choice Eligible >=$50 < 80' END END AS EXCLUSION,
		COUNT(*) AS CNT
		FROM CE_LOANS
		WHERE EXCL_10 = '9999-SELECTED' AND BORROWER_TYPE = 'P' AND (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) AND (LTV_B <= 80 OR FLG_GSE_VALUE = 'N')
		GROUP BY
		OFFER_10,
		CASE WHEN LTV_B >= 80 THEN CASE WHEN SPL_CHK = 'Y' THEN '9014-Options Eligible >=$50 (HARP) > 80' ELSE '9015-Single Choice Eligible >= $50 (HARP) > 80' END ELSE CASE WHEN SPL_CHK = 'Y' THEN '9016-Options Eligible >=$50 < 80' ELSE '9017-Single Choice Eligible >=$50 < 80' END END

		UNION ALL

		SELECT
		OFFER_11 AS OFFER,
		CASE WHEN LTV_B >= 80 THEN CASE WHEN SPL_CHK = 'Y' THEN '9014-Options Eligible >=$50 (HARP) > 80' ELSE '9015-Single Choice Eligible >= $50 (HARP) > 80' END ELSE CASE WHEN SPL_CHK = 'Y' THEN '9016-Options Eligible >=$50 < 80' ELSE '9017-Single Choice Eligible >=$50 < 80' END END AS EXCLUSION,
		COUNT(*) AS CNT
		FROM CE_LOANS
		WHERE EXCL_11 = '9999-SELECTED' AND BORROWER_TYPE = 'P' AND (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) AND (LTV_B <= 80 OR FLG_GSE_VALUE = 'N')
		GROUP BY
		OFFER_11,
		CASE WHEN LTV_B >= 80 THEN CASE WHEN SPL_CHK = 'Y' THEN '9014-Options Eligible >=$50 (HARP) > 80' ELSE '9015-Single Choice Eligible >= $50 (HARP) > 80' END ELSE CASE WHEN SPL_CHK = 'Y' THEN '9016-Options Eligible >=$50 < 80' ELSE '9017-Single Choice Eligible >=$50 < 80' END END

		UNION ALL

		SELECT
		OFFER_12 AS OFFER,
		CASE WHEN LTV_B >= 80 THEN CASE WHEN SPL_CHK = 'Y' THEN '9014-Options Eligible >=$50 (HARP) > 80' ELSE '9015-Single Choice Eligible >= $50 (HARP) > 80' END ELSE CASE WHEN SPL_CHK = 'Y' THEN '9016-Options Eligible >=$50 < 80' ELSE '9017-Single Choice Eligible >=$50 < 80' END END AS EXCLUSION,
		COUNT(*) AS CNT
		FROM CE_LOANS
		WHERE EXCL_12 = '9999-SELECTED' AND BORROWER_TYPE = 'P' AND (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) AND (LTV_B <= 80 OR FLG_GSE_VALUE = 'N')
		GROUP BY
		OFFER_12,
		CASE WHEN LTV_B >= 80 THEN CASE WHEN SPL_CHK = 'Y' THEN '9014-Options Eligible >=$50 (HARP) > 80' ELSE '9015-Single Choice Eligible >= $50 (HARP) > 80' END ELSE CASE WHEN SPL_CHK = 'Y' THEN '9016-Options Eligible >=$50 < 80' ELSE '9017-Single Choice Eligible >=$50 < 80' END END

		UNION ALL

		SELECT
		OFFER_13 AS OFFER,
		CASE WHEN LTV_B >= 80 THEN CASE WHEN SPL_CHK = 'Y' THEN '9014-Options Eligible >=$50 (HARP) > 80' ELSE '9015-Single Choice Eligible >= $50 (HARP) > 80' END ELSE CASE WHEN SPL_CHK = 'Y' THEN '9016-Options Eligible >=$50 < 80' ELSE '9017-Single Choice Eligible >=$50 < 80' END END AS EXCLUSION,
		COUNT(*) AS CNT
		FROM CE_LOANS
		WHERE EXCL_13 = '9999-SELECTED' AND BORROWER_TYPE = 'P' AND (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) AND (LTV_B <= 80 OR FLG_GSE_VALUE = 'N')
		GROUP BY
		OFFER_13,
		CASE WHEN LTV_B >= 80 THEN CASE WHEN SPL_CHK = 'Y' THEN '9014-Options Eligible >=$50 (HARP) > 80' ELSE '9015-Single Choice Eligible >= $50 (HARP) > 80' END ELSE CASE WHEN SPL_CHK = 'Y' THEN '9016-Options Eligible >=$50 < 80' ELSE '9017-Single Choice Eligible >=$50 < 80' END END

		UNION ALL

		SELECT
		OFFER_14 AS OFFER,
		CASE WHEN LTV_B >= 80 THEN CASE WHEN SPL_CHK = 'Y' THEN '9014-Options Eligible >=$50 (HARP) > 80' ELSE '9015-Single Choice Eligible >= $50 (HARP) > 80' END ELSE CASE WHEN SPL_CHK = 'Y' THEN '9016-Options Eligible >=$50 < 80' ELSE '9017-Single Choice Eligible >=$50 < 80' END END AS EXCLUSION,
		SUM(0) AS CNT
		FROM CE_LOANS
		WHERE EXCL_14 = '9999-SELECTED' AND BORROWER_TYPE = 'P' AND (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) AND (LTV_B <= 80 OR FLG_GSE_VALUE = 'N')
		GROUP BY
		OFFER_14,
		CASE WHEN LTV_B >= 80 THEN CASE WHEN SPL_CHK = 'Y' THEN '9014-Options Eligible >=$50 (HARP) > 80' ELSE '9015-Single Choice Eligible >= $50 (HARP) > 80' END ELSE CASE WHEN SPL_CHK = 'Y' THEN '9016-Options Eligible >=$50 < 80' ELSE '9017-Single Choice Eligible >=$50 < 80' END END

		UNION ALL

		SELECT
		OFFER_15 AS OFFER,
		CASE WHEN LTV_B >= 80 THEN CASE WHEN SPL_CHK = 'Y' THEN '9014-Options Eligible >=$50 (HARP) > 80' ELSE '9015-Single Choice Eligible >= $50 (HARP) > 80' END ELSE CASE WHEN SPL_CHK = 'Y' THEN '9016-Options Eligible >=$50 < 80' ELSE '9017-Single Choice Eligible >=$50 < 80' END END AS EXCLUSION,
		SUM(0) AS CNT
		FROM CE_LOANS
		WHERE EXCL_15 = '9999-SELECTED' AND BORROWER_TYPE = 'P' AND (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) AND (LTV_B <= 80 OR FLG_GSE_VALUE = 'N')
		GROUP BY
		OFFER_15,
		CASE WHEN LTV_B >= 80 THEN CASE WHEN SPL_CHK = 'Y' THEN '9014-Options Eligible >=$50 (HARP) > 80' ELSE '9015-Single Choice Eligible >= $50 (HARP) > 80' END ELSE CASE WHEN SPL_CHK = 'Y' THEN '9016-Options Eligible >=$50 < 80' ELSE '9017-Single Choice Eligible >=$50 < 80' END END

		UNION ALL

		SELECT
		OFFER_16 AS OFFER,
		CASE WHEN LTV_B >= 80 THEN CASE WHEN SPL_CHK = 'Y' THEN '9014-Options Eligible >=$50 (HARP) > 80' ELSE '9015-Single Choice Eligible >= $50 (HARP) > 80' END ELSE CASE WHEN SPL_CHK = 'Y' THEN '9016-Options Eligible >=$50 < 80' ELSE '9017-Single Choice Eligible >=$50 < 80' END END AS EXCLUSION,
		SUM(0) AS CNT
		FROM CE_LOANS
		WHERE EXCL_16 = '9999-SELECTED' AND BORROWER_TYPE = 'P' AND (NEW_PI_SAVINGS_MO >= 70 OR (NEW_PI_SAVINGS_MO BETWEEN 50 AND 69.99 AND UNPAID_BALANCE >= 95000)) AND (LTV_B <= 80 OR FLG_GSE_VALUE = 'N')
		GROUP BY
		OFFER_16,
		CASE WHEN LTV_B >= 80 THEN CASE WHEN SPL_CHK = 'Y' THEN '9014-Options Eligible >=$50 (HARP) > 80' ELSE '9015-Single Choice Eligible >= $50 (HARP) > 80' END ELSE CASE WHEN SPL_CHK = 'Y' THEN '9016-Options Eligible >=$50 < 80' ELSE '9017-Single Choice Eligible >=$50 < 80' END END
	)
	GROUP BY
	EXCLUSION
) A,
(SELECT MAX(RATE_DT) AS RATE_DT FROM CE_LOANS) C;
COMMIT;

INSERT INTO CAMPAIGN_WATERFALL_SUMMARY
SELECT
C.RATE_DATE,
'9020-<80 >=$50 HARP & Non-HARP (9010+9012)' AS EXCLUSION,
SUM(CASE WHEN EXCLUSION IN ('9010-New PI Savings >= $50 HARP <80', '9012-New PI Savings >= $50 Non-HARP <80') THEN EMAIL_REFI ELSE 0 END) AS EMAIL_REFI,
SUM(CASE WHEN EXCLUSION IN ('9010-New PI Savings >= $50 HARP <80', '9012-New PI Savings >= $50 Non-HARP <80') THEN EMAIL_PURCHASE ELSE 0 END) AS EMAIL_PURCHASE,
SUM(CASE WHEN EXCLUSION IN ('9010-New PI Savings >= $50 HARP <80', '9012-New PI Savings >= $50 Non-HARP <80') THEN EMAIL_ONE_DAY_SALE ELSE 0 END) AS EMAIL_ONE_DAY_SALE,
SUM(CASE WHEN EXCLUSION IN ('9010-New PI Savings >= $50 HARP <80', '9012-New PI Savings >= $50 Non-HARP <80') THEN EMAIL_SERVICING ELSE 0 END) AS EMAIL_SERVICING,
SUM(CASE WHEN EXCLUSION IN ('9010-New PI Savings >= $50 HARP <80', '9012-New PI Savings >= $50 Non-HARP <80') THEN EMAIL_RACING ELSE 0 END) AS EMAIL_RACING,
SUM(CASE WHEN EXCLUSION IN ('9010-New PI Savings >= $50 HARP <80', '9012-New PI Savings >= $50 Non-HARP <80') THEN DIRECT_MAIL_REFI ELSE 0 END) AS DIRECT_MAIL_REFI,
SUM(CASE WHEN EXCLUSION IN ('9010-New PI Savings >= $50 HARP <80', '9012-New PI Savings >= $50 Non-HARP <80') THEN DIRECT_MAIL_PURCHASE ELSE 0 END) AS DIRECT_MAIL_PURCHASE,
SUM(CASE WHEN EXCLUSION IN ('9010-New PI Savings >= $50 HARP <80', '9012-New PI Savings >= $50 Non-HARP <80') THEN DIRECT_MAIL_SERVICING ELSE 0 END) AS DIRECT_MAIL_SERVICING,
SUM(CASE WHEN EXCLUSION IN ('9010-New PI Savings >= $50 HARP <80', '9012-New PI Savings >= $50 Non-HARP <80') THEN DIRECT_MAIL_RACING ELSE 0 END) AS DIRECT_MAIL_RACING,
SUM(CASE WHEN EXCLUSION IN ('9010-New PI Savings >= $50 HARP <80', '9012-New PI Savings >= $50 Non-HARP <80') THEN SERVICING_TRANSFERS ELSE 0 END) AS SERVICING_TRANSFERS,
SUM(CASE WHEN EXCLUSION IN ('9010-New PI Savings >= $50 HARP <80', '9012-New PI Savings >= $50 Non-HARP <80') THEN STATEMENT_INSERT_SERVICING ELSE 0 END) AS STATEMENT_INSERT_SERVICING,
SUM(CASE WHEN EXCLUSION IN ('9010-New PI Savings >= $50 HARP <80', '9012-New PI Savings >= $50 Non-HARP <80') THEN STATEMENT_INSERT_REFI ELSE 0 END) AS STATEMENT_INSERT_REFI,
SUM(CASE WHEN EXCLUSION IN ('9010-New PI Savings >= $50 HARP <80', '9012-New PI Savings >= $50 Non-HARP <80') THEN STATEMENT_INSERT_PURCHASE ELSE 0 END) AS STATEMENT_INSERT_PURCHASE,
SUM(CASE WHEN EXCLUSION IN ('9010-New PI Savings >= $50 HARP <80', '9012-New PI Savings >= $50 Non-HARP <80') THEN ALL_HAMP_MOD_DM ELSE 0 END) AS ALL_HAMP_MOD_DM,
SUM(CASE WHEN EXCLUSION IN ('9010-New PI Savings >= $50 HARP <80', '9012-New PI Savings >= $50 Non-HARP <80') THEN FORBEARANCE_LOANS_DM ELSE 0 END) AS FORBEARANCE_LOANS_DM,
SUM(CASE WHEN EXCLUSION IN ('9010-New PI Savings >= $50 HARP <80', '9012-New PI Savings >= $50 Non-HARP <80') THEN SECOND_LIEN_DM ELSE 0 END) AS SECOND_LIEN_DM
FROM CAMPAIGN_WATERFALL_SUMMARY C
WHERE RATE_DATE IN (SELECT MAX(RATE_DT) FROM CE_LOANS)
GROUP BY
C.RATE_DATE;
COMMIT;

INSERT INTO CAMPAIGN_WATERFALL_SUMMARY
SELECT
C.RATE_DATE,
'9021-One Day Sale >=$50 HARP & Non-HARP (9009+9010+9011+9012)' AS EXCLUSION,
SUM(CASE WHEN EXCLUSION IN ('9009-New PI Savings >= $50 HARP >80', '9010-New PI Savings >= $50 HARP <80', '9011-New PI Savings >= $50 Non-HARP >80', '9012-New PI Savings >= $50 Non-HARP <80') THEN EMAIL_REFI ELSE 0 END) AS EMAIL_REFI,
SUM(CASE WHEN EXCLUSION IN ('9009-New PI Savings >= $50 HARP >80', '9010-New PI Savings >= $50 HARP <80', '9011-New PI Savings >= $50 Non-HARP >80', '9012-New PI Savings >= $50 Non-HARP <80') THEN EMAIL_PURCHASE ELSE 0 END) AS EMAIL_PURCHASE,
SUM(CASE WHEN EXCLUSION IN ('9009-New PI Savings >= $50 HARP >80', '9010-New PI Savings >= $50 HARP <80', '9011-New PI Savings >= $50 Non-HARP >80', '9012-New PI Savings >= $50 Non-HARP <80') THEN EMAIL_ONE_DAY_SALE ELSE 0 END) AS EMAIL_ONE_DAY_SALE,
SUM(CASE WHEN EXCLUSION IN ('9009-New PI Savings >= $50 HARP >80', '9010-New PI Savings >= $50 HARP <80', '9011-New PI Savings >= $50 Non-HARP >80', '9012-New PI Savings >= $50 Non-HARP <80') THEN EMAIL_SERVICING ELSE 0 END) AS EMAIL_SERVICING,
SUM(CASE WHEN EXCLUSION IN ('9009-New PI Savings >= $50 HARP >80', '9010-New PI Savings >= $50 HARP <80', '9011-New PI Savings >= $50 Non-HARP >80', '9012-New PI Savings >= $50 Non-HARP <80') THEN EMAIL_RACING ELSE 0 END) AS EMAIL_RACING,
SUM(CASE WHEN EXCLUSION IN ('9009-New PI Savings >= $50 HARP >80', '9010-New PI Savings >= $50 HARP <80', '9011-New PI Savings >= $50 Non-HARP >80', '9012-New PI Savings >= $50 Non-HARP <80') THEN DIRECT_MAIL_REFI ELSE 0 END) AS DIRECT_MAIL_REFI,
SUM(CASE WHEN EXCLUSION IN ('9009-New PI Savings >= $50 HARP >80', '9010-New PI Savings >= $50 HARP <80', '9011-New PI Savings >= $50 Non-HARP >80', '9012-New PI Savings >= $50 Non-HARP <80') THEN DIRECT_MAIL_PURCHASE ELSE 0 END) AS DIRECT_MAIL_PURCHASE,
SUM(CASE WHEN EXCLUSION IN ('9009-New PI Savings >= $50 HARP >80', '9010-New PI Savings >= $50 HARP <80', '9011-New PI Savings >= $50 Non-HARP >80', '9012-New PI Savings >= $50 Non-HARP <80') THEN DIRECT_MAIL_SERVICING ELSE 0 END) AS DIRECT_MAIL_SERVICING,
SUM(CASE WHEN EXCLUSION IN ('9009-New PI Savings >= $50 HARP >80', '9010-New PI Savings >= $50 HARP <80', '9011-New PI Savings >= $50 Non-HARP >80', '9012-New PI Savings >= $50 Non-HARP <80') THEN DIRECT_MAIL_RACING ELSE 0 END) AS DIRECT_MAIL_RACING,
SUM(CASE WHEN EXCLUSION IN ('9009-New PI Savings >= $50 HARP >80', '9010-New PI Savings >= $50 HARP <80', '9011-New PI Savings >= $50 Non-HARP >80', '9012-New PI Savings >= $50 Non-HARP <80') THEN SERVICING_TRANSFERS ELSE 0 END) AS SERVICING_TRANSFERS,
SUM(CASE WHEN EXCLUSION IN ('9009-New PI Savings >= $50 HARP >80', '9010-New PI Savings >= $50 HARP <80', '9011-New PI Savings >= $50 Non-HARP >80', '9012-New PI Savings >= $50 Non-HARP <80') THEN STATEMENT_INSERT_SERVICING ELSE 0 END) AS STATEMENT_INSERT_SERVICING,
SUM(CASE WHEN EXCLUSION IN ('9009-New PI Savings >= $50 HARP >80', '9010-New PI Savings >= $50 HARP <80', '9011-New PI Savings >= $50 Non-HARP >80', '9012-New PI Savings >= $50 Non-HARP <80') THEN STATEMENT_INSERT_REFI ELSE 0 END) AS STATEMENT_INSERT_REFI,
SUM(CASE WHEN EXCLUSION IN ('9009-New PI Savings >= $50 HARP >80', '9010-New PI Savings >= $50 HARP <80', '9011-New PI Savings >= $50 Non-HARP >80', '9012-New PI Savings >= $50 Non-HARP <80') THEN STATEMENT_INSERT_PURCHASE ELSE 0 END) AS STATEMENT_INSERT_PURCHASE,
SUM(CASE WHEN EXCLUSION IN ('9009-New PI Savings >= $50 HARP >80', '9010-New PI Savings >= $50 HARP <80', '9011-New PI Savings >= $50 Non-HARP >80', '9012-New PI Savings >= $50 Non-HARP <80') THEN ALL_HAMP_MOD_DM ELSE 0 END) AS ALL_HAMP_MOD_DM,
SUM(CASE WHEN EXCLUSION IN ('9009-New PI Savings >= $50 HARP >80', '9010-New PI Savings >= $50 HARP <80', '9011-New PI Savings >= $50 Non-HARP >80', '9012-New PI Savings >= $50 Non-HARP <80') THEN FORBEARANCE_LOANS_DM ELSE 0 END) AS FORBEARANCE_LOANS_DM,
SUM(CASE WHEN EXCLUSION IN ('9009-New PI Savings >= $50 HARP >80', '9010-New PI Savings >= $50 HARP <80', '9011-New PI Savings >= $50 Non-HARP >80', '9012-New PI Savings >= $50 Non-HARP <80') THEN SECOND_LIEN_DM ELSE 0 END) AS SECOND_LIEN_DM
FROM CAMPAIGN_WATERFALL_SUMMARY C
WHERE RATE_DATE IN (SELECT MAX(RATE_DT) FROM CE_LOANS)
GROUP BY
C.RATE_DATE;
COMMIT;

INSERT INTO CAMPAIGN_WATERFALL_SUMMARY
SELECT
R.RATE_DATE,
'9022-June 2017 Email Addresses from MyAcct/DigAlerts/OnlineBill' AS EXCLUSION,
SUM(CASE WHEN C.EXCL_1 = '9999-SELECTED' AND A.ACCOUNT_NUMBER IS NOT NULL THEN 1 ELSE 0 END) AS EMAIL_REFI,
SUM(CASE WHEN C.EXCL_2 = '9999-SELECTED' AND A.ACCOUNT_NUMBER IS NOT NULL THEN 1 ELSE 0 END) AS EMAIL_PURCHASE,
SUM(CASE WHEN C.EXCL_3 = '9999-SELECTED' AND A.ACCOUNT_NUMBER IS NOT NULL THEN 1 ELSE 0 END) AS EMAIL_ONE_DAY_SALE,
SUM(CASE WHEN C.EXCL_4 = '9999-SELECTED' AND A.ACCOUNT_NUMBER IS NOT NULL THEN 1 ELSE 0 END) AS EMAIL_SERVICING,
SUM(CASE WHEN C.EXCL_5 = '9999-SELECTED' AND A.ACCOUNT_NUMBER IS NOT NULL THEN 1 ELSE 0 END) AS EMAIL_RACING,
NULL AS DIRECT_MAIL_REFI,
NULL AS DIRECT_MAIL_PURCHASE,
NULL AS DIRECT_MAIL_SERVICING,
NULL AS DIRECT_MAIL_RACING,
NULL AS SERVICING_TRANSFERS,
NULL AS STATEMENT_INSERT_SERVICING,
NULL AS STATEMENT_INSERT_REFI,
NULL AS STATEMENT_INSERT_PURCHASE,
NULL AS ALL_HAMP_MOD_DM,
NULL AS FORBEARANCE_LOANS_DM,
NULL AS SECOND_LIEN_DM
FROM CE_LOANS C, (SELECT DISTINCT ACCOUNT_NUMBER FROM NEW_EMAIL_LIST_20170605) A,
(SELECT MAX(RATE_DT) AS RATE_DATE FROM CE_LOANS) R
WHERE C.ACCOUNT_NUMBER = A.ACCOUNT_NUMBER(+)
AND C.BORROWER_TYPE = 'P'
GROUP BY
R.RATE_DATE;
COMMIT;

